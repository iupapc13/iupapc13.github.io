<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  

  
    
      <link rel="stylesheet" href="/semantic/dist/semantic.min.css" />
    
      <link rel="stylesheet" href="/assets/css/product.css" />
    
      <link rel="stylesheet" href="/assets/css/highlight.css" />
    
  

  

  

  

  

  
  
  
  

    <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="Post 1" />
  


   
  <meta property="description" content="Post summary for all posts page.">
  

   
  <meta property="og:description" content="Post summary for all posts page.">
  

   
  <meta name="description" content="Describe post heading">
  


  
  <meta property="article:published_time" content="2020-05-03T00:00:00+05:30">
  <meta property="article:author" content="http://localhost:4000/about/">
  
  
  <meta itemprop="keywords" content="new,post,sometag" />
  
  <meta property="article:tag" content="new">
  
  <meta property="article:tag" content="post">
  
  <meta property="article:tag" content="sometag">
  
  
  
  
  <meta property="article:author" content="Ajith B.P" />
  


  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="http://localhost:4000//work/newpost.html" />
  <link rel="canonical" href="http://localhost:4000//work/newpost.html" />
  


  <meta property="og:image" content="http://localhost:4000/assets/blog/clamping.png" />


  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@csparkresearch" />
  <meta name="twitter:creator" content="@csparkresearch" />

  
  <meta name="twitter:title" content="Post 1" />
  

  
  <meta name="twitter:description" content="Post summary for all posts page.">
  

  <meta name="twitter:image" content="http://localhost:4000/assets/blog/clamping.png" />



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67472997-3"></script>
<script>
	var host = window.location.hostname;
	if(host == "localhost")
	{
		console.log('Developer Mode');
		window['ga-disable-UA-3'] = true;
	}

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');



</script>



    <title>Post 1</title>


</head>


<body>

<!-- Sidebar Menu -->
<div class="ui sidebar large vertical menu">
    <a class="header item" href="/"><img class="ui image small" src="/assets/images/logo.png" /></a>
	
        <div class="ui item">
			Resources
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/journal/index.html">Open Access Journals</a>

              
              <a class=" item" href="/scientific/index.html">Scientific Instruments</a>

              
              <a class=" item" href="/laboratory/index.html">Laboratory Equipment</a>

              
			</div>
		  </div>        
        
    
</div>



<!-- Page Contents -->
<div class="pusher">
	
  <div class="ui inverted vertical center aligned segment" style="background:url(/assets/images/cover.jpg) #f2bd91 fixed top center; " >

    <div class="ui container">
		<div class="ui menu large inverted secondary pointing">
	<div class="sidebar reveal float left">
		<a class="toc item overlay blog fixed">
		  <i class="icon list layout large"></i><span class="text">Menu</span>
		</a>
	</div>
	<div class=" item">
		<img src="/assets/images/avatar-icon.png">
		<a href="/" class="ui inverted blue button">Home</a>
    </div>
	
        <div class="ui dropdown item">
			Resources
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/journal/index.html">Open Access Journals</a>

              
              <a class=" item" href="/scientific/index.html">Scientific Instruments</a>

              
              <a class=" item" href="/laboratory/index.html">Laboratory Equipment</a>

              
			</div>
		  </div>        
        
    

  <div class="right menu">
    <!--<div class="item">
      <div class="ui action left icon input">
        <i class="search icon"></i>
        <input type="text" placeholder="Search">
        <button class="ui button">Submit</button>
      </div>
    </div>-->
  </div>

</div>

    </div>

    <div class="ui text container">
      <h1 class="ui inverted header">
        Post 1
      </h1>
      <h2>Describe post heading</h2>
      <!--<div class="ui huge primary button">Get Started <i class="right arrow icon"></i></div> -->
    </div>
  </div>

	

	
	<div class="ui container">
	  <div class="ui clearing hidden divider"></div>	
	  <div class="ui relaxed divided items">
		<div class="item">
		  <div class="ui large image raised segment">
			<img src="/assets/blog/clamping.png">
		  </div>
		  <div class="content">
			<a class="ui dividing header red"><i class="paperclip icon"></i>Brief Summary</a>
			<div class="meta">
			    <a>work/</a>
			</div>
			<div class="description large">
			  Post summary for all posts page.
			</div>
			<div class="extra">
			  <div>May 03, 2020</div>
				
				<a class="ui basic image large label right floated">
				  <img src="/assets/images/ajith.jpg">
				  Ajith B.P
				</a>
			</div>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="ui clearing divider"></div>	

	
	<div class="ui internally celled stackable grid">
		<div class="row">
			<div class="ui column three wide mobile hidden" id="leftbar" >
				<div class="ui sticky container leftbar">
					<div class="ui hidden divider"></div>	
					<a class="ui small inverted fluid purple left labeled icon button" href="/blog"><i class="left arrow icon"></i>Posts</a>
					<div class="ui divider"></div>	
					<div class="ui divided selection list">
					
					 
					 
					
					</div>			
				  
				  
				  <div class="ui red fluid raised card">
					  <div class="content">
						<div class="ui small teal header">Post 1</div>
						<div class="center aligned description">
						  <p>Authored On: May 03, 2020</p>
						</div>
					  </div>
					  <div class="extra content">
						<div class="center aligned author">
						  <img class="ui avatar image" src="/assets/images/ajith.jpg"> Ajith B.P
						</div>
					  </div>
				  </div>
			      

				</div>
			</div>
			<div class="ui column ten wide blog" style="padding:30px;" id="toc-leftbar">

				<p><img src="/assets/blog/clamping.png" alt="" class="ui image medium lightbox floated" /></p>

<div class="ui clearing divider"></div>

<h2 id="first-order-ordinary-differential-equations">First Order Ordinary Differential Equations</h2>

<p>Differential equations are one of the most important mathematical tools used in producing models for physical and biological processes. Analytic solutions are available in some cases but numerical methods are employed for solving most of the problems encountered in science and engineering. Here we explore some of the popular methods for solving the initial value problems involving first-order ordinary differential equations(ODE). The focus will be on solving simple examples using Python programming language. The Python basics required 
for understanding the examples is given <a href="./python/index.html">here</a></p>

<p>Consider the differential equation,</p>

<p>:math:<code class="highlighter-rouge">\frac{dy}{dx}=f(x,y)</code>  with an initial value :math:<code class="highlighter-rouge">y(x_0) = y_0</code></p>

<p>The derivative of the function and the value of the function at some initial value are known. The objective is to find out the value of the function for other values of x, starting from the given initial point. The underlying idea of any routine for solving the initial value problem is to rewrite the dy and dx as finite steps :math:<code class="highlighter-rouge">\Delta x</code> and :math:<code class="highlighter-rouge">\Delta x</code>, to convert the differential equation to an algebraic equation.</p>

<p>:math:<code class="highlighter-rouge">y(x_{i+1}) = y_i + \Delta y  = y_i + \frac{\Delta y}{\Delta x} \times {\Delta x} = y_i + \frac{dy}{dx} \times {\Delta x}</code></p>

<p>In the limit of making :math:<code class="highlighter-rouge">\Delta x</code> very small, a good approximation to the underlying differential equation is achieved. The process can be explained better with some examples. We choose a known function so that the error in the result can be easily checked.</p>

<p><a href="code/euler-sine.py">euler-sine.py</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>		<span class="c1"># derivative of the function to be evaluated
</span>	<span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>			<span class="c1"># number of points
</span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span> <span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>	<span class="c1"># stepsize. Note that the Number of steps = Number of points -1 
</span>
<span class="n">xa</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   	<span class="c1"># numpy array of store the variable values
</span><span class="n">ya</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>	<span class="c1"># numpy array to store results
</span>
<span class="n">xa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fxy</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>   <span class="c1"># Euler method
</span>	
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	<span class="n">ya</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">f1</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
	<span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>

<span class="k">print</span> <span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="s">'Err = '</span><span class="p">,</span> <span class="n">ya</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>   <span class="c1"># the last point and error
</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="s">'x-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span> <span class="s">'+-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="ODE1/pics/euler-sine.png" alt="" /></p>

<p>The output of the code is shown above. We have deliberately selected a very large stepsize to show the error. The lower graph, marked with dots, are the correct values. The points marked with crosses are the outputs of the calculation. The reason for error is very clear. The Euler method which advances a solution from :math:<code class="highlighter-rouge">x_i</code> to :math:<code class="highlighter-rouge">x_{i+1}</code> is not symmetric, it advances the solution through an interval h, but uses derivative information only at the beginning of that interval.</p>

<p>Better results are obtained if we take trial step to the midpoint of the interval and use the value of both x and y at that point to compute the real step across the whole interval. This is called the second-order Runge-Kutta or the midpoint method. To learn about the theory refer to <code class="highlighter-rouge">Runge-Kutta methods</code>_  , <code class="highlighter-rouge">Second order Runge-Kutta methods</code>_ or any other good books on numerical methods.</p>

<p><a href="http://www.math.iit.edu/~fass/478578_Chapter_3.pdf">Runge-Kutta methods</a>
<a href="http://mathforcollege.com/nm/mws/gen/08ode/mws_gen_ode_txt_runge2nd.pdf">Second order Runge-Kutta methods</a></p>

<p><a href="code/euler-sine.py">rk2-sine.py</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>		<span class="c1"># derivative of the function to be evaluated
</span>	<span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>				<span class="c1"># number of points
</span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 	<span class="c1"># stepsize. Note that the Number of steps = Number of points -1 
</span>
<span class="n">xa</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   	<span class="c1"># numpy array of store the variable values
</span><span class="n">ya</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>	<span class="c1"># numpy array to store results
</span>
<span class="n">xa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">def</span> <span class="nf">rk2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fxy</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>   <span class="c1"># x, y , f(x,y)
</span>	<span class="n">k1</span> <span class="o">=</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
	<span class="n">k2</span> <span class="o">=</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span> <span class="n">k1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">k2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	<span class="n">ya</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rk2</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">f1</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
	<span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>

<span class="k">print</span> <span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="s">'Err = '</span><span class="p">,</span> <span class="n">ya</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
	 
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="s">'x-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span> <span class="s">'o-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="ODE1/pics/rk2-sine.png" alt="" class="ui image medium lightbox floated" /></p>

<p>This procedure can be further extended to higher orders. The fourth order Runge-Kutta method is the most popular one and is commonly referred as the Runge-Kutta method. In each step the derivative is evaluated four times as shown in figure below. Once at the initial point, twice at trial midpoints, and once at a trial endpoint. Every trial evaluation uses the value of the function from the previous trial point, ie. :math:<code class="highlighter-rouge">k_2</code> is evaluated using :math:<code class="highlighter-rouge">k_1</code> and not using :math:<code class="highlighter-rouge">y_i</code>. From these derivatives the final function value is calculated.</p>

<p><a href="ODE1/code/rk4-sine.py">rk4-sine.py</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>		<span class="c1"># derivative of the function to be evaluated
</span>	<span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>				<span class="c1"># number of points
</span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   	<span class="c1"># stepsize. Note that the Number of steps = Number of points -1 
</span>
<span class="n">xa</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   	<span class="c1"># numpy array of store the variable values
</span><span class="n">ya</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>	<span class="c1"># numpy array to store results
</span>
<span class="n">xa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">def</span> <span class="nf">rk4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fxy</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>   <span class="c1"># x, y , f(x,y)
</span>	<span class="n">k1</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
	<span class="n">k2</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">k1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
	<span class="n">k3</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">k2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
	<span class="n">k4</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fxy</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">k3</span><span class="p">)</span>
	<span class="k">return</span>  <span class="n">y</span> <span class="o">+</span> <span class="p">(</span> <span class="n">k1</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span> <span class="n">k2</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="n">k3</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="n">k4</span><span class="o">/</span><span class="mi">6</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	<span class="n">ya</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rk4</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">f1</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
	<span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span>

<span class="k">print</span> <span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="s">'Err = '</span><span class="p">,</span> <span class="n">ya</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="s">'x-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span> <span class="s">'o-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="ODE1/pics/rk4-sine.png" alt="" class="ui image medium lightbox floated" /></p>

<p>The reduction is error is clearly visible. We have used very coarse steps to highlight the error. You may change the value of ‘N’ in the code and rerun. Outputs for N=100 are shown below. Also change the code to remove the marking of points.</p>

<p><img src="ODE1/pics/euler-sine-100N.png" alt="" class="ui image medium lightbox floated" /></p>

<p>As we explained earlier, the error is due to the fact that the value of the derivative changes within the interval but the calculations assume the derivative at the starting point or obtained by some averaging. This can be demonstrated by choosing a function representing a straight line, where derivative is constant, as shown in the example below.</p>


				<div class="ui clearing divider"></div>

			</div>
			<div class="ui column three wide mobile hidden" id="toc-sidebar">
				<div class="ui sticky toc container" id="toc">
					<div class="ui hidden divider"></div>
					<a class="ui mini inverted fluid brown left labeled icon button" href="/expeyes17/"><i class="home icon"></i>ExpEYES Home</a>
					
				</div>
			</div>
		</div>

	</div>
	<div class="ui clearing divider"></div>	


	

	<div class="ui grid">
		<div class="row">
			<div class = "ui column  wide">
				<div class="ui container">
					
					
				</div>

		</div>
	</div>

 
      </div>
    </div>
  </div>


  </div>











  
	<script src="/assets/js/jquery.min.js"></script>
  
	<script src="/semantic/dist/semantic.min.js"></script>
  
	<script src="/assets/js/mainsemantic.js"></script>
  
	<script src="/assets/js/toc.js"></script>
  





</body>
</html> 


